<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>XR DEFENSE - FINAL</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <link rel="stylesheet" href="css/style.css">

    <script src="js/main.js"></script>
    <script src="js/tower.js"></script>
    <script src="js/spawner.js"></script>
    <script src="js/controller.js"></script>
</head>
<body>

<div id="overlay">
    <div class="scroll-container">
        <h1>XR DEFENSE</h1>
        <div class="separator">â™¦</div>
        <p>1. Scan floor/tables.</p>
        <p>2. Aim with RIGHT controller.</p>
        <p>3. Trigger to build (50 Gold).</p>
        <button id="xr-button" style="display: inline-block; z-index:99999;">START GAME</button>
    </div>
</div>

<div id="game-over" style="display:none; position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(50,0,0,0.9); z-index:99999; flex-direction:column; align-items:center; justify-content:center;">
    <h1 style="color:red; font-size:4rem;">DEFEAT</h1>
    <button onclick="location.reload()" style="padding:20px; font-size:2rem;">RETRY</button>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('xr-button').addEventListener('click', () => {
            document.querySelector('a-scene').enterAR();
            document.getElementById('overlay').style.display = 'none';
        });
    });
</script>

<a-scene
        ar-game-controller
        game-manager
        enemy-spawner
        webxr="requiredFeatures: hit-test, local-floor; optionalFeatures: dom-overlay; overlayElement: #overlay"
        renderer="colorManagement: true; alpha: true"
        vr-mode-ui="enabled: false"
        background="color: transparent">

    <a-light type="directional" intensity="1" position="-1 2 2"></a-light>
    <a-light type="ambient" intensity="0.5"></a-light>

    <a-camera position="0 1.6 0">
        <a-entity id="hud-group" position="0 -0.25 -0.5" rotation="-15 0 0">
            <a-plane color="black" opacity="0.5" width="0.8" height="0.15" position="0 0.15 -0.01"></a-plane>

            <a-text id="hud-hp" value="HP: 20" color="#FF4444" position="-0.3 0.15 0" width="1.5"></a-text>
            <a-text id="hud-gold" value="GOLD: 100" color="#FFD700" position="0.1 0.15 0" width="1.5"></a-text>
        </a-entity>
    </a-camera>

    <a-entity oculus-touch-controls="hand: right"></a-entity>
    <a-entity oculus-touch-controls="hand: left"></a-entity>

    <a-entity id="reticle" visible="false">
        <a-ring color="#00FF00" radius-inner="0.04" radius-outer="0.05" rotation="-90 0 0"></a-ring>
        <a-cylinder color="#00FF00" height="0.1" radius="0.005" position="0 0.05 0"></a-cylinder>
    </a-entity>

</a-scene>
</body>
</html>